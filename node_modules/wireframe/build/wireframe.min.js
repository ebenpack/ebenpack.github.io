/*

 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License


 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License

*/
!function(A){if("object"==typeof exports)module.exports=A();else if("function"==typeof define&&define.amd)define(A);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self);f.wireframe=A()}}(function(){return function f(h,m,b){function k(c,e){if(!m[c]){if(!h[c]){var a="function"==typeof require&&require;if(!e&&a)return a(c,!0);if(l)return l(c,!0);throw Error("Cannot find module '"+c+"'");}a=m[c]={exports:{}};h[c][0].call(a.exports,function(a){var p=
h[c][1][a];return k(p?p:a)},a,a.exports,f,h,m,b)}return m[c].exports}for(var l="function"==typeof require&&require,c=0;c<b.length;c++)k(b[c]);return k}({1:[function(f,h,m){function b(a,d){var p,b,r={};"string"===typeof a?(a=a.toLowerCase(),a in e?r=e[a]:(r=g(a),e[a]=r),b=r,p=c(r.r,r.g,r.b),d=r.a||d||1):"r"in a?(b=a,p=c(a.r,a.g,a.b),d=p.a||d||1):"h"in a&&(p=a,b=l(a.h,a.s,a.l),d=b.a||d||1);this.rgb={r:b.r,g:b.g,b:b.b};this.hsl={h:p.h,s:p.s,l:p.l};this.alpha=d;this._color_string=this._toString()}function k(a,
d,c){a<d?a=d:a>c&&(a=c);return a}var l,c,g,e;b.prototype.lighten=function(a){var d=this.hsl;a=d.l+a;100<a&&(a=100);return new b({h:d.h,s:d.s,l:a},this.alpha)};b.prototype.darken=function(a){var d=this.hsl;a=d.l-a;0>a&&(a=0);return new b({h:d.h,s:d.s,l:a},this.alpha)};b.prototype.toString=function(){return this._color_string};b.prototype._toString=function(){var a=this.rgb.r.toString(16),d=this.rgb.g.toString(16),c=this.rgb.b.toString(16);1===a.length&&(a="0"+a);1===d.length&&(d="0"+d);1===c.length&&
(c="0"+c);return"#"+a+d+c};l=function(a,d,c){function b(a,d,c){0>c&&(c+=1);1<c&&(c-=1);return c<1/6?a+(d-a)*c*6:.5>c?d:c<2/3?a+(d-a)*(2/3-c)*6:a}var g=c/100,e=d/100;if(0===d)return a=255*g,{r:a,g:a,b:a};d=50>=c?g*(1+e):g+e-g*e;g=2*g-d;a/=360;return{r:Math.round(255*b(g,d,a+1/3)),g:Math.round(255*b(g,d,a)),b:Math.round(255*b(g,d,a-1/3))}};c=function(a,d,c){a/=255;d/=255;c/=255;var b=Math.max(a,d,c),g=Math.min(a,d,c),e=Math.round((g+b)/2*100);100<e&&(e=100);0>e&&(e=0);var n;if(g===b)return{h:0,s:0,
l:e};n=50>=e?(b-g)/(b+g):(b-g)/(2-b-g);var f=(b-a)/(b-g),q=(b-d)/(b-g);c=(b-c)/(b-g);a=(a===b?c-q:d===b?2+f-c:4+q-f)/6%1;0>a&&(a+=1);a=Math.round(360*a);n=Math.round(100*n);360<a&&(a=360);0>a&&(a=0);100<n&&(n=100);0>n&&(n=0);return{h:a,s:n,l:e}};g=function(a){var d,c,b,g=1,e,n=!1;e=a.substr(0,3);if("hsl"===e)(e=/hsla?\(\s*(-?\d+)\s*,\s*(-?\d+)%\s*,\s*(-?\d+)%\s*(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(a))?(d=parseInt(e[1],10),c=parseInt(e[2],10),b=parseInt(e[3],10),"a"===a[3]&&(g=parseFloat(e[5])),d=Math.abs(d%
360),c=k(c,0,100),b=k(b,0,100),e=l(d,c,b),d=e.r,c=e.g,b=e.b):n=!0;else if("rgb"===e)if(e=/rgba?\((-?\d+%?)\s*,\s*(-?\d+%?)\s*,\s*(-?\d+%?)(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(a)){var f=e[1],q=e[2],h=e[3];d=parseInt(e[1],10);c=parseInt(e[2],10);b=parseInt(e[3],10);if("%"===f[f.length-1]||"%"===q[q.length-1]||"%"===h[h.length-1])"%"===f[f.length-1]&&"%"===q[q.length-1]&&"%"===h[h.length-1]?(d=Math.floor(d/100*255),c=Math.floor(c/100*255),b=Math.floor(b/100*255)):n=!0;d=k(d,0,255);c=k(c,0,255);b=k(b,0,
255);"a"===a[3]&&(g=parseFloat(e[5]))}else n=!0;else"#"===a[0]?(e=a.substr(1),3===e.length?(d=parseInt(e[0]+e[0],16),c=parseInt(e[1]+e[1],16),b=parseInt(e[2]+e[2],16)):6===e.length?(d=parseInt(e[0]+e[1],16),c=parseInt(e[2]+e[3],16),b=parseInt(e[4]+e[5],16)):n=!0):n=!0;g=k(g,0,1);if(n)throw"ColourError: Something went wrong. Perhaps "+a+" is not a legal CSS color value";return{r:d,g:c,b:b,a:g}};e={black:{r:0,g:0,b:0,h:0,s:0,l:0},silver:{r:192,g:192,b:192,h:0,s:0,l:75},gray:{r:128,g:128,b:128,h:0,s:0,
l:50},white:{r:255,g:255,b:255,h:0,s:0,l:100},maroon:{r:128,g:0,b:0,h:0,s:100,l:25},red:{r:255,g:0,b:0,h:0,s:100,l:50},purple:{r:128,g:0,b:128,h:300,s:100,l:25},fuchsia:{r:255,g:0,b:255,h:300,s:100,l:50},green:{r:0,g:128,b:0,h:120,s:100,l:25},lime:{r:0,g:255,b:0,h:120,s:100,l:50},olive:{r:128,g:128,b:0,h:60,s:100,l:25},yellow:{r:255,g:255,b:0,h:60,s:100,l:50},navy:{r:0,g:0,b:128,h:240,s:100,l:25},blue:{r:0,g:0,b:255,h:240,s:100,l:50},teal:{r:0,g:128,b:128,h:180,s:100,l:25},aqua:{r:0,g:255,b:255,h:180,
s:100,l:50},orange:{r:255,g:165,b:0,h:39,s:100,l:50},aliceblue:{r:240,g:248,b:255,h:208,s:100,l:97},antiquewhite:{r:250,g:235,b:215,h:34,s:78,l:91},aquamarine:{r:127,g:255,b:212,h:160,s:100,l:75},azure:{r:240,g:255,b:255,h:180,s:100,l:97},beige:{r:245,g:245,b:220,h:60,s:56,l:91},bisque:{r:255,g:228,b:196,h:33,s:100,l:88},blanchedalmond:{r:255,g:235,b:205,h:36,s:100,l:90},blueviolet:{r:138,g:43,b:226,h:271,s:76,l:53},brown:{r:165,g:42,b:42,h:0,s:59,l:41},burlywood:{r:222,g:184,b:135,h:34,s:57,l:70},
cadetblue:{r:95,g:158,b:160,h:182,s:25,l:50},chartreuse:{r:127,g:255,b:0,h:90,s:100,l:50},chocolate:{r:210,g:105,b:30,h:25,s:75,l:47},coral:{r:255,g:127,b:80,h:16,s:100,l:66},cornflowerblue:{r:100,g:149,b:237,h:219,s:79,l:66},cornsilk:{r:255,g:248,b:220,h:48,s:100,l:93},cyan:{r:0,g:255,b:255,h:180,s:100,l:97},crimson:{r:220,g:20,b:60,h:348,s:83,l:47},darkblue:{r:0,g:0,b:139,h:240,s:100,l:27},darkcyan:{r:0,g:139,b:139,h:180,s:100,l:27},darkgoldenrod:{r:184,g:134,b:11,h:43,s:89,l:38},darkgray:{r:169,
g:169,b:169,h:0,s:0,l:66},darkgreen:{r:0,g:100,b:0,h:120,s:100,l:20},darkgrey:{r:169,g:169,b:169,h:0,s:0,l:66},darkkhaki:{r:189,g:183,b:107,h:56,s:38,l:58},darkmagenta:{r:139,g:0,b:139,h:300,s:100,l:27},darkolivegreen:{r:85,g:107,b:47,h:82,s:39,l:30},darkorange:{r:255,g:140,b:0,h:33,s:100,l:50},darkorchid:{r:153,g:50,b:204,h:280,s:61,l:50},darkred:{r:139,g:0,b:0,h:0,s:100,l:27},darksalmon:{r:233,g:150,b:122,h:15,s:72,l:70},darkseagreen:{r:143,g:188,b:143,h:120,s:25,l:65},darkslateblue:{r:72,g:61,
b:139,h:248,s:39,l:39},darkslategray:{r:47,g:79,b:79,h:180,s:25,l:25},darkslategrey:{r:47,g:79,b:79,h:180,s:25,l:25},darkturquoise:{r:0,g:206,b:209,h:181,s:100,l:41},darkviolet:{r:148,g:0,b:211,h:282,s:100,l:41},deeppink:{r:255,g:20,b:147,h:328,s:100,l:54},deepskyblue:{r:0,g:191,b:255,h:195,s:100,l:50},dimgray:{r:105,g:105,b:105,h:0,s:0,l:41},dimgrey:{r:105,g:105,b:105,h:0,s:0,l:41},dodgerblue:{r:30,g:144,b:255,h:210,s:100,l:56},firebrick:{r:178,g:34,b:34,h:0,s:68,l:42},floralwhite:{r:255,g:250,b:240,
h:40,s:100,l:97},forestgreen:{r:34,g:139,b:34,h:120,s:61,l:34},gainsboro:{r:220,g:220,b:220,h:0,s:0,l:86},ghostwhite:{r:248,g:248,b:255,h:240,s:100,l:99},gold:{r:255,g:215,b:0,h:51,s:100,l:50},goldenrod:{r:218,g:165,b:32,h:43,s:74,l:49},greenyellow:{r:173,g:255,b:47,h:84,s:100,l:59},grey:{r:128,g:128,b:128,h:0,s:0,l:50},honeydew:{r:240,g:255,b:240,h:120,s:100,l:97},hotpink:{r:255,g:105,b:180,h:330,s:100,l:71},indianred:{r:205,g:92,b:92,h:0,s:53,l:58},indigo:{r:75,g:0,b:130,h:275,s:100,l:25},ivory:{r:255,
g:255,b:240,h:60,s:100,l:97},khaki:{r:240,g:230,b:140,h:54,s:77,l:75},lavender:{r:230,g:230,b:250,h:240,s:67,l:94},lavenderblush:{r:255,g:240,b:245,h:340,s:100,l:97},lawngreen:{r:124,g:252,b:0,h:90,s:100,l:49},lemonchiffon:{r:255,g:250,b:205,h:54,s:100,l:90},lightblue:{r:173,g:216,b:230,h:195,s:53,l:79},lightcoral:{r:240,g:128,b:128,h:0,s:79,l:72},lightcyan:{r:224,g:255,b:255,h:180,s:100,l:94},lightgoldenrodyellow:{r:250,g:250,b:210,h:60,s:80,l:90},lightgray:{r:211,g:211,b:211,h:0,s:0,l:83},lightgreen:{r:144,
g:238,b:144,h:120,s:73,l:75},lightgrey:{r:211,g:211,b:211,h:0,s:0,l:83},lightpink:{r:255,g:182,b:193,h:351,s:100,l:86},lightsalmon:{r:255,g:160,b:122,h:17,s:100,l:74},lightseagreen:{r:32,g:178,b:170,h:177,s:70,l:41},lightskyblue:{r:135,g:206,b:250,h:203,s:92,l:75},lightslategray:{r:119,g:136,b:153,h:210,s:14,l:53},lightslategrey:{r:119,g:136,b:153,h:210,s:14,l:53},lightsteelblue:{r:176,g:196,b:222,h:214,s:41,l:78},lightyellow:{r:255,g:255,b:224,h:60,s:100,l:94},limegreen:{r:50,g:205,b:50,h:120,s:61,
l:50},linen:{r:250,g:240,b:230,h:30,s:67,l:94},magenta:{r:255,g:0,b:255,h:17,s:100,l:74},mediumaquamarine:{r:102,g:205,b:170,h:160,s:51,l:60},mediumblue:{r:0,g:0,b:205,h:240,s:100,l:40},mediumorchid:{r:186,g:85,b:211,h:288,s:59,l:58},mediumpurple:{r:147,g:112,b:219,h:260,s:60,l:65},mediumseagreen:{r:60,g:179,b:113,h:147,s:50,l:47},mediumslateblue:{r:123,g:104,b:238,h:249,s:80,l:67},mediumspringgreen:{r:0,g:250,b:154,h:157,s:100,l:49},mediumturquoise:{r:72,g:209,b:204,h:178,s:60,l:55},mediumvioletred:{r:199,
g:21,b:133,h:322,s:81,l:43},midnightblue:{r:25,g:25,b:112,h:240,s:64,l:27},mintcream:{r:245,g:255,b:250,h:150,s:100,l:98},mistyrose:{r:255,g:228,b:225,h:6,s:100,l:94},moccasin:{r:255,g:228,b:181,h:38,s:100,l:85},navajowhite:{r:255,g:222,b:173,h:36,s:100,l:84},oldlace:{r:253,g:245,b:230,h:39,s:85,l:95},olivedrab:{r:107,g:142,b:35,h:80,s:60,l:35},orangered:{r:255,g:69,b:0,h:16,s:100,l:50},orchid:{r:218,g:112,b:214,h:302,s:59,l:65},palegoldenrod:{r:238,g:232,b:170,h:55,s:67,l:80},palegreen:{r:152,g:251,
b:152,h:120,s:93,l:79},paleturquoise:{r:175,g:238,b:238,h:180,s:65,l:81},palevioletred:{r:219,g:112,b:147,h:340,s:60,l:65},papayawhip:{r:255,g:239,b:213,h:37,s:100,l:92},peachpuff:{r:255,g:218,b:185,h:28,s:100,l:86},peru:{r:205,g:133,b:63,h:30,s:59,l:53},pink:{r:255,g:192,b:203,h:350,s:100,l:88},plum:{r:221,g:160,b:221,h:300,s:47,l:75},powderblue:{r:176,g:224,b:230,h:187,s:52,l:80},rosybrown:{r:188,g:143,b:143,h:0,s:25,l:65},royalblue:{r:65,g:105,b:225,h:225,s:73,l:57},saddlebrown:{r:139,g:69,b:19,
h:25,s:76,l:31},salmon:{r:250,g:128,b:114,h:6,s:93,l:71},sandybrown:{r:244,g:164,b:96,h:28,s:87,l:67},seagreen:{r:46,g:139,b:87,h:146,s:50,l:36},seashell:{r:255,g:245,b:238,h:25,s:100,l:97},sienna:{r:160,g:82,b:45,h:19,s:56,l:40},skyblue:{r:135,g:206,b:235,h:197,s:71,l:73},slateblue:{r:106,g:90,b:205,h:248,s:53,l:58},slategray:{r:112,g:128,b:144,h:210,s:13,l:50},slategrey:{r:112,g:128,b:144,h:210,s:13,l:50},snow:{r:255,g:250,b:250,h:0,s:100,l:99},springgreen:{r:0,g:255,b:127,h:150,s:100,l:50},steelblue:{r:70,
g:130,b:180,h:207,s:44,l:49},tan:{r:210,g:180,b:140,h:34,s:44,l:69},thistle:{r:216,g:191,b:216,h:300,s:24,l:80},tomato:{r:255,g:99,b:71,h:9,s:100,l:64},turquoise:{r:64,g:224,b:208,h:174,s:72,l:56},violet:{r:238,g:130,b:238,h:300,s:76,l:72},wheat:{r:245,g:222,b:179,h:39,s:77,l:83},whitesmoke:{r:245,g:245,b:245,h:0,s:0,l:96},yellowgreen:{r:154,g:205,b:50,h:80,s:61,l:50}};h.exports=b},{}],2:[function(f,h,m){m=f("./vector.js");f=f("./matrix.js");var b=Object.create(null);b.Vector=m;b.Matrix=f;h.exports=
b},{"./matrix.js":3,"./vector.js":4}],3:[function(f,h,m){function b(){for(var a=0;16>a;a++)this[a]=0;this.length=16}f=f("./vector.js");b.prototype.equal=function(a){for(var d=0,c=this.length;d<c;d++)if(this[d]!==a[d])return!1;return!0};b.prototype.add=function(a){for(var d=new b,c=0,g=this.length;c<g;c++)d[c]=this[c]+a[c];return d};b.prototype.addLG=function(a,d){d[0]=this[0]+a[0];d[1]=this[1]+a[1];d[2]=this[2]+a[2];d[3]=this[3]+a[3];d[4]=this[4]+a[4];d[5]=this[5]+a[5];d[6]=this[6]+a[6];d[7]=this[7]+
a[7];d[8]=this[8]+a[8];d[9]=this[9]+a[9];d[10]=this[10]+a[10];d[11]=this[11]+a[11];d[12]=this[12]+a[12];d[13]=this[13]+a[13];d[14]=this[14]+a[14];d[15]=this[15]+a[15];return d};b.prototype.subtract=function(a){for(var d=new b,c=0,g=this.length;c<g;c++)d[c]=this[c]-a[c];return d};b.prototype.subtractLG=function(a,d){d[0]=this[0]-a[0];d[1]=this[1]-a[1];d[2]=this[2]-a[2];d[3]=this[3]-a[3];d[4]=this[4]-a[4];d[5]=this[5]-a[5];d[6]=this[6]-a[6];d[7]=this[7]-a[7];d[8]=this[8]-a[8];d[9]=this[9]-a[9];d[10]=
this[10]-a[10];d[11]=this[11]-a[11];d[12]=this[12]-a[12];d[13]=this[13]-a[13];d[14]=this[14]-a[14];d[15]=this[15]-a[15];return d};b.prototype.multiplyScalar=function(a){for(var d=new b,c=0,g=this.length;c<g;c++)d[c]=this[c]*a;return d};b.prototype.multiplyScalarLG=function(a,d){d[0]=this[0]*a;d[1]=this[1]*a;d[2]=this[2]*a;d[3]=this[3]*a;d[4]=this[4]*a;d[5]=this[5]*a;d[6]=this[6]*a;d[7]=this[7]*a;d[8]=this[8]*a;d[9]=this[9]*a;d[10]=this[10]*a;d[11]=this[11]*a;d[12]=this[12]*a;d[13]=this[13]*a;d[14]=
this[14]*a;d[15]=this[15]*a;return d};b.prototype.multiply=function(a){var d=new b;d[0]=this[0]*a[0]+this[1]*a[4]+this[2]*a[8]+this[3]*a[12];d[1]=this[0]*a[1]+this[1]*a[5]+this[2]*a[9]+this[3]*a[13];d[2]=this[0]*a[2]+this[1]*a[6]+this[2]*a[10]+this[3]*a[14];d[3]=this[0]*a[3]+this[1]*a[7]+this[2]*a[11]+this[3]*a[15];d[4]=this[4]*a[0]+this[5]*a[4]+this[6]*a[8]+this[7]*a[12];d[5]=this[4]*a[1]+this[5]*a[5]+this[6]*a[9]+this[7]*a[13];d[6]=this[4]*a[2]+this[5]*a[6]+this[6]*a[10]+this[7]*a[14];d[7]=this[4]*
a[3]+this[5]*a[7]+this[6]*a[11]+this[7]*a[15];d[8]=this[8]*a[0]+this[9]*a[4]+this[10]*a[8]+this[11]*a[12];d[9]=this[8]*a[1]+this[9]*a[5]+this[10]*a[9]+this[11]*a[13];d[10]=this[8]*a[2]+this[9]*a[6]+this[10]*a[10]+this[11]*a[14];d[11]=this[8]*a[3]+this[9]*a[7]+this[10]*a[11]+this[11]*a[15];d[12]=this[12]*a[0]+this[13]*a[4]+this[14]*a[8]+this[15]*a[12];d[13]=this[12]*a[1]+this[13]*a[5]+this[14]*a[9]+this[15]*a[13];d[14]=this[12]*a[2]+this[13]*a[6]+this[14]*a[10]+this[15]*a[14];d[15]=this[12]*a[3]+this[13]*
a[7]+this[14]*a[11]+this[15]*a[15];return d};b.prototype.multiplyLG=function(a,d){d[0]=this[0]*a[0]+this[1]*a[4]+this[2]*a[8]+this[3]*a[12];d[1]=this[0]*a[1]+this[1]*a[5]+this[2]*a[9]+this[3]*a[13];d[2]=this[0]*a[2]+this[1]*a[6]+this[2]*a[10]+this[3]*a[14];d[3]=this[0]*a[3]+this[1]*a[7]+this[2]*a[11]+this[3]*a[15];d[4]=this[4]*a[0]+this[5]*a[4]+this[6]*a[8]+this[7]*a[12];d[5]=this[4]*a[1]+this[5]*a[5]+this[6]*a[9]+this[7]*a[13];d[6]=this[4]*a[2]+this[5]*a[6]+this[6]*a[10]+this[7]*a[14];d[7]=this[4]*
a[3]+this[5]*a[7]+this[6]*a[11]+this[7]*a[15];d[8]=this[8]*a[0]+this[9]*a[4]+this[10]*a[8]+this[11]*a[12];d[9]=this[8]*a[1]+this[9]*a[5]+this[10]*a[9]+this[11]*a[13];d[10]=this[8]*a[2]+this[9]*a[6]+this[10]*a[10]+this[11]*a[14];d[11]=this[8]*a[3]+this[9]*a[7]+this[10]*a[11]+this[11]*a[15];d[12]=this[12]*a[0]+this[13]*a[4]+this[14]*a[8]+this[15]*a[12];d[13]=this[12]*a[1]+this[13]*a[5]+this[14]*a[9]+this[15]*a[13];d[14]=this[12]*a[2]+this[13]*a[6]+this[14]*a[10]+this[15]*a[14];d[15]=this[12]*a[3]+this[13]*
a[7]+this[14]*a[11]+this[15]*a[15];return d};b.prototype.negate=function(){for(var a=new b,d=0,c=this.length;d<c;d++)a[d]=-this[d];return a};b.prototype.negateLG=function(a){a[0]=-this[0];a[1]=-this[1];a[2]=-this[2];a[3]=-this[3];a[4]=-this[4];a[5]=-this[5];a[6]=-this[6];a[7]=-this[7];a[8]=-this[8];a[9]=-this[9];a[10]=-this[10];a[11]=-this[11];a[12]=-this[12];a[13]=-this[13];a[14]=-this[14];a[15]=-this[15];return a};b.prototype.transpose=function(){var a=new b;a[0]=this[0];a[1]=this[4];a[2]=this[8];
a[3]=this[12];a[4]=this[1];a[5]=this[5];a[6]=this[9];a[7]=this[13];a[8]=this[2];a[9]=this[6];a[10]=this[10];a[11]=this[14];a[12]=this[3];a[13]=this[7];a[14]=this[11];a[15]=this[15];return a};b.prototype.transposeLG=function(a){a[0]=this[0];a[1]=this[4];a[2]=this[8];a[3]=this[12];a[4]=this[1];a[5]=this[5];a[6]=this[9];a[7]=this[13];a[8]=this[2];a[9]=this[6];a[10]=this[10];a[11]=this[14];a[12]=this[3];a[13]=this[7];a[14]=this[11];a[15]=this[15];return a};b.prototype.empty=function(){for(var a=0,d=this.length;a<
d;a++)this[a]=0};b.prototype.copy=function(a){for(var d=0;16>d;d++)a[d]=this[d];return a};b.rotationX=function(a){var d=new b,c=Math.cos(a);a=Math.sin(a);d[0]=1;d[5]=c;d[6]=-a;d[9]=a;d[10]=c;d[15]=1;return d};b.rotationXLG=function(a,d){var c=Math.cos(a),b=Math.sin(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=c;d[6]=-b;d[7]=0;d[8]=0;d[9]=b;d[10]=c;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};b.rotationY=function(a){var d=new b,c=Math.cos(a);a=Math.sin(a);d[0]=c;d[2]=a;d[5]=1;d[8]=-a;d[10]=c;d[15]=
1;return d};b.rotationYLG=function(a,d){var c=Math.cos(a),b=Math.sin(a);d[0]=c;d[1]=0;d[2]=b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=-b;d[9]=0;d[10]=c;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};b.rotationZ=function(a){var d=new b,c=Math.cos(a);a=Math.sin(a);d[0]=c;d[1]=-a;d[4]=a;d[5]=c;d[10]=1;d[15]=1;return d};b.rotationZLG=function(a,d){var c=Math.cos(a),b=Math.sin(a);d[0]=c;d[1]=-b;d[2]=0;d[3]=0;d[4]=b;d[5]=c;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};
b.rotationAxis=function(a,d){var c=new b,g=a.normalize(),e=Math.sin(d),f=Math.cos(d),n=1-f,k=g.x,q=g.y,g=g.z,h=k*q,l=k*g,m=q*g;c[0]=f+k*k*n;c[1]=h*n-g*e;c[2]=l*n+q*e;c[4]=h*n+g*e;c[5]=f+q*q*n;c[6]=m*n-k*e;c[8]=l*n-q*e;c[9]=m*n+k*e;c[10]=f+g*g*n;c[15]=1;return c};b.rotationAxisLG=function(a,d,c){a.normalizeLG(e);a=Math.sin(d);d=Math.cos(d);var b=1-d,g=e.x,f=e.y,n=e.z,k=g*f,q=g*n,h=f*n;c[0]=d+g*g*b;c[1]=k*b-n*a;c[2]=q*b+f*a;c[3]=0;c[4]=k*b+n*a;c[5]=d+f*f*b;c[6]=h*b-g*a;c[7]=0;c[8]=q*b-f*a;c[9]=h*b+
g*a;c[10]=d+n*n*b;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};b.rotation=function(a,d,c){return b.rotationX(c).multiply(b.rotationZ(d)).multiply(b.rotationY(a))};b.rotationLG=function(a,d,e,B){b.rotationXLG(e,k);b.rotationZLG(d,l);b.rotationYLG(a,c);k.multiplyLG(l,g);g.multiplyLG(c,B);return B};b.translation=function(a,d,c){var g=b.identity();g[12]=a;g[13]=d;g[14]=c;return g};b.translationLG=function(a,d,c,b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[12]=
a;b[13]=d;b[14]=c;b[15]=1;return b};b.scale=function(a,d,c){var g=new b;g[0]=a;g[5]=d;g[10]=c;g[15]=1;return g};b.scaleLG=function(a,d,c,b){b[0]=a;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=d;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=c;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};b.identity=function(){var a=new b;a[0]=1;a[5]=1;a[10]=1;a[15]=1;return a};b.identityLG=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.zero=
function(){return new b};b.zeroLG=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=0;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=0;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=0;return a};b.fromArray=function(a){for(var d=new b,c=0;16>c;c++)d[c]=a[c];return d};b.fromArrayLG=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};b.copy=function(a,d){for(var c=0;16>c;c++)d[c]=
a[c];return d};var k=new b,l=new b,c=new b,g=new b,e=new f(0,0,0);h.exports=b},{"./vector.js":4}],4:[function(f,h,m){function b(c,b,e){if("undefined"===typeof c||"undefined"===typeof b||"undefined"===typeof e)throw Error("Insufficient arguments.");this.x=c;this.y=b;this.z=e}b.prototype.add=function(c){return new b(this.x+c.x,this.y+c.y,this.z+c.z)};b.prototype.addLG=function(c,b){b.x=this.x+c.x;b.y=this.y+c.y;b.z=this.z+c.z;return b};b.prototype.subtract=function(c){return new b(this.x-c.x,this.y-
c.y,this.z-c.z)};b.prototype.subtractLG=function(c,b){b.x=this.x-c.x;b.y=this.y-c.y;b.z=this.z-c.z;return b};b.prototype.equal=function(c){return this.x===c.x&&this.y===c.y&&this.z===c.z};b.prototype.angle=function(c){var b=this.normalize();c=c.normalize();var e=b.magnitude(),a=c.magnitude();if(0===e||0===a)return 0;b=b.dot(c)/(e*a);-1>b&&(b=-1);1<b&&(b=1);return Math.acos(b)};b.prototype.angleLG=function(c){this.normalizeLG(k);c.normalizeLG(l);c=k.magnitude();var b=l.magnitude();if(0===c||0===b)return 0;
c=k.dot(l)/(c*b);-1>c&&(c=-1);1<c&&(c=1);return Math.acos(c)};b.prototype.cosAngle=function(c){var b=this.normalize();c=c.normalize();var e=b.magnitude(),a=c.magnitude();if(0===e||0===a)return 0;b=b.dot(c)/(e*a);-1>b&&(b=-1);1<b&&(b=1);return b};b.prototype.cosAngleLG=function(c){this.normalizeLG(k);c.normalizeLG(l);c=k.magnitude();var b=l.magnitude();if(0===c||0===b)return 0;c=k.dot(l)/(c*b);-1>c&&(c=-1);1<c&&(c=1);return c};b.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*
this.y+this.z*this.z)};b.prototype.magnitudeSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z};b.prototype.dot=function(c){return this.x*c.x+this.y*c.y+this.z*c.z};b.prototype.cross=function(c){return new b(this.y*c.z-this.z*c.y,this.z*c.x-this.x*c.z,this.x*c.y-this.y*c.x)};b.prototype.crossLG=function(c,b){b.x=this.y*c.z-this.z*c.y;b.y=this.z*c.x-this.x*c.z;b.z=this.x*c.y-this.y*c.x;return b};b.prototype.normalize=function(){var c=this.magnitude();return 0===c?new b(this.x,this.y,
this.z):new b(this.x/c,this.y/c,this.z/c)};b.prototype.normalizeLG=function(c){var b=this.magnitude();0===b&&(c.x=this.x,c.y=this.y,c.z=this.z);c.x=this.x/b;c.y=this.y/b;c.z=this.z/b;return c};b.prototype.scale=function(c){return new b(this.x*c,this.y*c,this.z*c)};b.prototype.scaleLG=function(c,b){b.x=this.x*c;b.y=this.y*c;b.z=this.z*c;return b};b.prototype.negate=function(){return new b(-this.x,-this.y,-this.z)};b.prototype.negateLG=function(c){c.x=-this.x;c.y=-this.y;c.z=-this.z;return c};b.prototype.vectorProjection=
function(c){var b=c.magnitude();return c.scale(this.dot(c)/(b*b))};b.prototype.vectorProjectionLG=function(c,b){var e=c.magnitude();c.scaleLG(this.dot(c)/(e*e),b);return b};b.prototype.scalarProjection=function(c){return this.dot(c)/c.magnitude()};b.prototype.transform=function(c){var g=this.x*c[3]+this.y*c[7]+this.z*c[11]+c[15];return new b((this.x*c[0]+this.y*c[4]+this.z*c[8]+c[12])/g,(this.x*c[1]+this.y*c[5]+this.z*c[9]+c[13])/g,(this.x*c[2]+this.y*c[6]+this.z*c[10]+c[14])/g)};b.prototype.transformLG=
function(c,b){var e=this.x*c[1]+this.y*c[5]+this.z*c[9]+c[13],a=this.x*c[2]+this.y*c[6]+this.z*c[10]+c[14],d=this.x*c[3]+this.y*c[7]+this.z*c[11]+c[15];b.x=(this.x*c[0]+this.y*c[4]+this.z*c[8]+c[12])/d;b.y=e/d;b.z=a/d;return b};b.prototype.rotate=function(c,g){var e=c.normalize(),a=Math.sin(g),d=Math.cos(g),p=1-d,f=e.x,k=e.y,h=e.z,n=e.x*e.y,l=e.x*e.z,e=e.y*e.z;return new b((d+f*f*p)*this.x+(n*p-h*a)*this.y+(l*p+k*a)*this.z,(n*p+h*a)*this.x+(d+k*k*p)*this.y+(e*p-f*a)*this.z,(l*p-k*a)*this.x+(e*p+f*
a)*this.y+(d+f*f*p)*this.z)};b.prototype.rotateLG=function(c,b,e){c.normalizeLG(e);c=Math.sin(b);b=Math.cos(b);var a=1-b,d=e.x,p=e.y,f=e.z,k=e.x*e.y,h=e.x*e.z,n=e.y*e.z,l=(k*a+f*c)*this.x+(b+p*p*a)*this.y+(n*a-d*c)*this.z,n=(h*a-p*c)*this.x+(n*a+d*c)*this.y+(b+d*d*a)*this.z;e.x=(b+d*d*a)*this.x+(k*a-f*c)*this.y+(h*a+p*c)*this.z;e.y=l;e.z=n;return e};b.prototype.rotateX=function(c){var g=Math.sin(c);c=Math.cos(c);return new b(this.x,c*this.y-g*this.z,g*this.y+c*this.z)};b.prototype.rotateXLG=function(c,
b){var e=Math.sin(c),a=Math.cos(c),d=a*this.y-e*this.z,e=e*this.y+a*this.z;b.x=this.x;b.y=d;b.z=e;return b};b.prototype.rotateY=function(c){var g=Math.sin(c);c=Math.cos(c);return new b(c*this.x+g*this.z,this.y,-(g*this.x)+c*this.z)};b.prototype.rotateYLG=function(c,b){var e=Math.sin(c),a=Math.cos(c),d=this.y,p=-(e*this.x)+a*this.z;b.x=a*this.x+e*this.z;b.y=d;b.z=p;return b};b.prototype.rotateZ=function(c){var g=Math.sin(c);c=Math.cos(c);return new b(c*this.x-g*this.y,g*this.x+c*this.y,this.z)};b.prototype.rotateZLG=
function(c,b){var e=Math.sin(c),a=Math.cos(c),d=e*this.x+a*this.y,p=this.z;b.x=a*this.x-e*this.y;b.y=d;b.z=p;return b};b.prototype.rotatePitchYawRoll=function(c,b,e){return this.rotateX(e).rotateY(c).rotateZ(b)};b.prototype.rotatePitchYawRollLG=function(b,g,e,a){this.rotateXLG(e,a);a.rotateYLG(b,a);a.rotateZLG(g,a);return a};var k=new b(0,0,0),l=new b(0,0,0);h.exports=b},{}],5:[function(f,h,m){function b(b,c,a){this.position=a||new k(1,1,20);this.up=new k(0,1,0);this.rotation={yaw:0,pitch:0,roll:0};
this.view_matrix=new l;this.width=b;this.height=c;this.near=.1;this.far=1E3;this.fov=90;this.perspectiveFov=new l;this._xaxis=new k(0,0,0);this._yaxis=new k(0,0,0);this._zaxis=new k(0,0,0);this._direction=new k(0,0,0);this._temp_vector1=new k(0,0,0);this._temp_vector2=new k(0,0,0);this._temp_matrix=new l;this.calculatePerspectiveFov();this.createViewMatrix()}f=f("linearalgea");var k=f.Vector,l=f.Matrix,c=2*Math.PI;b.prototype.direction=function(){var b=Math.sin(this.rotation.pitch),c=Math.cos(this.rotation.pitch),
a=Math.sin(this.rotation.yaw),d=Math.cos(this.rotation.yaw);this._direction.x=-c*a;this._direction.y=b;this._direction.z=-c*d};b.prototype.calculatePerspectiveFov=function(){var b=this.width/this.height,c=this.near,a=this.far,d=1/Math.tan(Math.PI/180*this.fov/2)*this.height;this.perspectiveFov[0]=d*b;this.perspectiveFov[5]=d;this.perspectiveFov[10]=a/(c-a);this.perspectiveFov[11]=-1;this.perspectiveFov[14]=c*a/(c-a)};b.prototype.createViewMatrix=function(){var b=this.position,c=this.rotation.pitch,
a=this.rotation.yaw,d=Math.cos(c),c=Math.sin(c),p=Math.cos(a),a=Math.sin(a);this._xaxis.x=p;this._xaxis.y=0;this._xaxis.z=-a;this._yaxis.x=a*c;this._yaxis.y=d;this._yaxis.z=p*c;this._zaxis.x=a*d;this._zaxis.y=-c;this._zaxis.z=d*p;l.fromArrayLG([this._xaxis.x,this._yaxis.x,this._zaxis.x,0,this._xaxis.y,this._yaxis.y,this._zaxis.y,0,this._xaxis.z,this._yaxis.z,this._zaxis.z,0,-this._xaxis.dot(b),-this._yaxis.dot(b),-this._zaxis.dot(b),1],this.view_matrix)};b.prototype.look=function(b,e){this.rotation.yaw-=
b;0>this.rotation.yaw?this.rotation.yaw+=c:this.rotation.yaw>c&&(this.rotation.yaw-=c);this.rotation.pitch-=e;0>this.rotation.pitch?this.rotation.pitch+=c:this.rotation.pitch>c&&(this.rotation.pitch-=c);this.createViewMatrix()};b.prototype.turnRight=function(b){this.rotation.yaw-=b;0>this.rotation.yaw&&(this.rotation.yaw+=c);this.createViewMatrix()};b.prototype.turnLeft=function(b){this.rotation.yaw+=b;this.rotation.yaw>c&&(this.rotation.yaw-=c);this.createViewMatrix()};b.prototype.lookUp=function(b){this.rotation.pitch-=
b;this.rotation.pitch>c&&(this.rotation.pitch-=c);this.createViewMatrix()};b.prototype.lookDown=function(b){this.rotation.pitch+=b;0>this.rotation.pitch&&(this.rotation.pitch+=c);this.createViewMatrix()};b.prototype.moveTo=function(b,c,a){this.position.x=b;this.position.y=c;this.position.z=a;this.createViewMatrix()};b.prototype.move=function(b,c,a){this.position.x+=b;this.position.y+=c;this.position.z+=a;this.createViewMatrix()};b.prototype.moveRight=function(b){this.direction();this._direction.normalizeLG(this._temp_vector1);
this._temp_vector1.scaleLG(b,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.subtractLG(this._temp_vector1,this.position);this.createViewMatrix()};b.prototype.moveLeft=function(b){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(b,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.addLG(this._temp_vector1,this.position);this.createViewMatrix()};b.prototype.moveUp=function(b){this.up.normalizeLG(this._temp_vector1);
this._temp_vector1.scaleLG(b,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};b.prototype.moveDown=function(b){this.up.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(b,this._temp_vector2);this.position.addLG(this._temp_vector2,this.position);this.createViewMatrix()};b.prototype.moveForward=function(b){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(b,this._temp_vector2);this.position.addLG(this._temp_vector2,
this.position);this.createViewMatrix()};b.prototype.moveBackward=function(b){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(b,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};h.exports=b},{linearalgea:2}],6:[function(f,h,m){m=f("./scene.js");f=f("./camera.js");h.exports.Scene=m;h.exports.Camera=f},{"./camera.js":5,"./scene.js":8}],7:[function(f,h,m){h.exports={_listeners:{},addListener:function(b,f){b in
this._listeners||(this._listeners[b]=[]);this._listeners[b].push(f)},fire:function(b,f){var h={};"undefined"!==typeof f&&(h=f);h.event=b;h.target=this;var c=this._listeners[b];if("undefined"!==typeof c)for(var g=0,e=c.length;g<e;g++)c[g].call(this,h)},removeListener:function(b,f){for(var h=this._listeners[b],c=0,g=h.length;c<g;c++)h[c]===f&&h.splice(c,1)}}},{}],8:[function(f,h,m){function b(d){this.width=d.width;this.height=d.height;this.canvas=document.getElementById(d.canvas_id);this.ctx=this.canvas.getContext("2d");
this.ctx.strokeStyle="red";this.camera=new k(this.width,this.height);this.illumination=new e(90,0,0);this.meshes={};this._x_offset=Math.round(this.width/2);this._y_offset=Math.round(this.height/2);this._back_buffer=document.createElement("canvas");this._back_buffer.width=this.width;this._back_buffer.height=this.height;this._back_buffer_ctx=this._back_buffer.getContext("2d");this._back_buffer_image=null;this._depth_buffer=[];this._backface_culling=!0;this._quickdraw=!1;this._keys={};this._key_count=
0;this._anim_id=null;this._needs_update=!0;this._draw_mode=0;this.canvas.tabIndex=1;this._back_buffer_image=this._back_buffer_ctx.createImageData(this.width,this.height);this.canvas.addEventListener("keydown",this.onKeyDown.bind(this),!1);this.canvas.addEventListener("keyup",this.onKeyUp.bind(this),!1);this.canvas.addEventListener("blur",this.emptyKeys.bind(this),!1);this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this),!1);this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this),
!1);this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this),!1);this.initializeDepthBuffer();this.update();this._light_direction=new e(0,0,0);this._wv1=new e(0,0,0);this._wv2=new e(0,0,0);this._wv3=new e(0,0,0);this._v1=new e(0,0,0);this._v2=new e(0,0,0);this._v3=new e(0,0,0);this._v1t=new e(0,0,0);this._v2t=new e(0,0,0);this._v3t=new e(0,0,0);this._wvp_matrix=new a;this._world_matrix=new a;this._rotation_matrix=new a;this._translation_matrix=new a;this._scale_matrix=new a;this._cam_to_vert=
new e(0,0,0);this._temp_matrix=new a;this._side1=new e(0,0,0);this._side2=new e(0,0,0);this._norm=new e(0,0,0)}m=f("linearalgea");var k=f("./camera.js"),l=f("./events.js"),c=f("../utilities/mixin.js"),g=f("../utilities/keycodes.js"),e=m.Vector,a=m.Matrix;c(b.prototype,l);b.prototype.emptyKeys=function(){this._key_count=0;this._keys={}};b.prototype.isKeyDown=function(a){a=g[a];return a in this._keys&&this._keys[a]};b.prototype.onKeyDown=function(a){a=a.keyCode||a.which;this.isKeyDown(a)||(this._key_count+=
1,this._keys[a]=!0)};b.prototype.onKeyUp=function(a){a=a.keyCode||a.which;a in this._keys&&(this._key_count-=1,this._keys[a]=!1)};b.prototype._getMousePos=function(a){var b=this.canvas.getBoundingClientRect();return{x:a.clientX-b.left,y:a.clientY-b.top}};b.prototype.onMouseDown=function(a){this._last_mouse_update=this._last_mouse_coords=void 0;a={mouse:this._getMousePos(a)};this.fire("mousedown",a);var b=this.onMouseDrag.bind(this),c=function(){this.removeEventListener("mousemove",b,!1);this.removeEventListener("mouseup",
c,!1);this._last_mouse_update=this._last_mouse_coords=void 0};this.canvas.addEventListener("mousemove",b,!1);this.canvas.addEventListener("mouseup",c,!1);this.canvas.addEventListener("mouseleave",c,!1)};b.prototype.onMouseUp=function(a){a={mouse:this._getMousePos(a)};this.fire("mouseup",a)};b.prototype.onMouseMove=function(a){a={mouse:this._getMousePos(a)};this.fire("mousemove",a)};b.prototype.onMouseDrag=function(a){a=this._getMousePos(a);"undefined"===typeof this._last_mouse_coords&&(this._last_mouse_coords=
a);"undefined"===typeof this._last_mouse_update&&(this._last_mouse_update=new Date);var b=new Date-this._last_mouse_update,c=a.x-this._last_mouse_coords.x,e=a.y-this._last_mouse_coords.y,g=0,f=0;0<b&&(g=c/b,f=e/b);c={mouse:{x:a.x,y:a.y,xvel:g,yvel:f,deltax:c,deltay:e}};this._last_mouse_coords=a;this._last_mouse_update=b;this.fire("mousedrag",c)};b.prototype.initializeDepthBuffer=function(){for(var a=0,b=this.width*this.height;a<b;a++)this._depth_buffer[a]=9999999};b.prototype._clear_back_buffer_image=
function(){for(var a=this._back_buffer_image.data,b=3;b<a.length;b+=4)a[b]=0};b.prototype.offscreen=function(a){var b=a.x+this._x_offset,c=a.y+this._y_offset;return 1<a.z||0>b||b>this.width||0>c||c>this.height};b.prototype.toggleDrawMode=function(){this._draw_mode=(this._draw_mode+1)%2;this.renderScene()};b.prototype.toggleBackfaceCulling=function(){this._backface_culling=!this._backface_culling;this.renderScene()};b.prototype.toggleQuickDraw=function(){this._quickdraw=!this._quickdraw;this.renderScene()};
b.prototype.drawPixel=function(a,b,c,e){a+=this._x_offset;b+=this._y_offset;if(0<=a&&a<this.width&&0<=b&&b<this.height&&(a+=b*this.width,c<this._depth_buffer[a])){b=this._back_buffer_image.data;var g=4*a;b[g]=e.rgb.r;b[g+1]=e.rgb.g;b[g+2]=e.rgb.b;b[g+3]=255;this._depth_buffer[a]=c}};b.prototype.drawEdge=function(a,b,c){var e=Math.abs;if(a.x>=b.x){var g=a;a=b;b=g}var g=a.x,f=a.y,h=a.z,e=Math.max(e(b.x-a.x),e(b.y-a.y),e(b.z-a.z)),k=(b.x-a.x)/e,l=(b.y-a.y)/e;a=(b.z-a.z)/e;for(b=0;b<e;b++)this.drawPixel(Math.floor(g),
Math.floor(f),h,c),g+=k,f+=l,h+=a};b.prototype.quickLine=function(a,b){var c=Math.round(a.x+this._x_offset),e=Math.round(a.y+this._y_offset),g=Math.round(b.x+this._x_offset),f=Math.round(b.y+this._y_offset);this.ctx.moveTo(c,e);this.ctx.lineTo(g,f)};b.prototype.drawTriangle=function(a,b,c,e){this._quickdraw?(this.quickLine(a,b),this.quickLine(b,c),this.quickLine(c,a)):(this.drawEdge(a,b,e),this.drawEdge(b,c,e),this.drawEdge(c,a,e))};b.prototype.fillTriangle=function(a,b,c,e){var g=a.x,f=b.x,h=c.x,
k=a.y,l=b.y,m=c.y;a=a.z;b=b.z;c=c.z;var w=0-this._x_offset,x=this.width-this._x_offset,y=0-this._y_offset,s=this.height-this._y_offset,t=Math.floor(Math.min(g,f,h));t<w&&(t=w);w=Math.ceil(Math.max(g,f,h));w>x&&(w=x);x=Math.floor(Math.min(k,l,m));x<y&&(x=y);y=Math.ceil(Math.max(k,l,m));y>s&&(y=s);for(var D=m-k,z=g-h,u=k-l,s=f-g,v=h*k-g*m,g=g*l-f*k,f=D*f+z*l+v,k=u*h+s*m+g,h=D/f,m=z/f,f=v/f,l=u/k,s=s/k,g=g/k;t<=w;t++)for(k=x;k<=y;k++)u=h*t+m*k+f,0<=u&&1>=u&&(v=l*t+s*k+g,0<=v&&1>=v&&(z=1-u-v,0<=z&&1>=
z&&this.drawPixel(t,k,z*a+u*b+v*c,e)))};b.prototype.renderScene=function(){this._quickdraw&&0===this._draw_mode?(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath()):(this._clear_back_buffer_image(),this.initializeDepthBuffer());var b=this.camera.view_matrix,c=this.camera.perspectiveFov,e=this.illumination,g;for(g in this.meshes)if(this.meshes.hasOwnProperty(g)){var f=this.meshes[g],k=f.scale,h=f.rotation,l=f.position;a.scaleLG(k.x,k.y,k.z,this._scale_matrix);a.rotationLG(h.pitch,
h.yaw,h.roll,this._rotation_matrix);a.translationLG(l.x,l.y,l.z,this._translation_matrix);this._scale_matrix.multiplyLG(this._rotation_matrix,this._world_matrix);this._world_matrix.multiplyLG(this._translation_matrix,this._world_matrix);for(k=0;k<f.faces.length;k++){var m=f.faces[k].face,h=f.faces[k].color,l=f.vertices[m[0]],C=f.vertices[m[1]],m=f.vertices[m[2]];l.transformLG(this._world_matrix,this._v1t);C.transformLG(this._world_matrix,this._v2t);m.transformLG(this._world_matrix,this._v3t);this.camera.position.subtractLG(this._v1t,
this._cam_to_vert);this._v2t.subtractLG(this._v1t,this._side1);this._v3t.subtractLG(this._v1t,this._side2);this._side1.crossLG(this._side2,this._norm);1E-8<=this._norm.magnitude()&&this._norm.normalizeLG(this._norm);if(!this._backface_culling||0<=this._cam_to_vert.dot(this._norm))this._world_matrix.multiplyLG(b,this._temp_matrix),this._temp_matrix.multiplyLG(c,this._wvp_matrix),l.transformLG(this._wvp_matrix,this._wv1),C.transformLG(this._wvp_matrix,this._wv2),m.transformLG(this._wvp_matrix,this._wv3),
l=!0,this.offscreen(this._wv1)&&this.offscreen(this._wv2)&&this.offscreen(this._wv3)&&(l=!1),l&&(0===this._draw_mode?this.drawTriangle(this._wv1,this._wv2,this._wv3,h):1===this._draw_mode&&(e.subtractLG(this._v1t,this._light_direction),this._light_direction.normalizeLG(this._light_direction),l=this._norm.dot(this._light_direction),h=h.lighten(15*l),this.fillTriangle(this._wv1,this._wv2,this._wv3,h)))}}this._quickdraw&&0===this._draw_mode?(this.ctx.stroke(),this.ctx.closePath()):(this._back_buffer_ctx.putImageData(this._back_buffer_image,
0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this._back_buffer,0,0,this.canvas.width,this.canvas.height))};b.prototype.addMesh=function(a){this.meshes[a.name]=a};b.prototype.removeMesh=function(a){delete this.meshes[a.name]};b.prototype.update=function(){0<this._key_count&&this.fire("keydown");this._needs_update&&(this.renderScene(),this._needs_update=!1);this._anim_id=window.requestAnimationFrame(this.update.bind(this))};h.exports=b},{"../utilities/keycodes.js":13,
"../utilities/mixin.js":14,"./camera.js":5,"./events.js":7,linearalgea:2}],9:[function(f,h,m){m=f("./geometry/geometry.js");f=f("./engine/engine.js");h.exports.geometry=m;h.exports.engine=f},{"./engine/engine.js":6,"./geometry/geometry.js":11}],10:[function(f,h,m){var b=f("colour");h.exports=function(f,h,c,g){this.face=[f,h,c];this.color=new b(g)}},{colour:1}],11:[function(f,h,m){m=f("./mesh.js");f=f("./face.js");h.exports.Mesh=m;h.exports.Face=f},{"./face.js":10,"./mesh.js":12}],12:[function(f,h,
m){function b(b,g,e){this.name=b;this.vertices=g;this.faces=e;this.position=new k(0,0,0);this.rotation={yaw:0,pitch:0,roll:0};this.scale={x:1,y:1,z:1}}var k=f("linearalgea").Vector,l=f("./face.js");b.fromJSON=function(c){for(var g=[],e=[],a=0,d=c.vertices.length;a<d;a++){var f=c.vertices[a];g.push(new k(f[0],f[1],f[2]))}a=0;for(d=c.faces.length;a<d;a++)f=c.faces[a],e.push(new l(f.face[0],f.face[1],f.face[2],f.color));return new b(c.name,g,e)};h.exports=b},{"./face.js":10,linearalgea:2}],13:[function(f,
h,m){h.exports={space:32,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps_lock:20,escape:27,page_up:33,"page down":34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"left_window key":91,"right_window key":92,select_key:93,"numpad 0":96,"numpad 1":97,"numpad 2":98,
"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,num_lock:144,scroll_lock:145,semi_colon:186,equal_sign:187,comma:188,dash:189,period:190,forward_slash:191,grave_accent:192,open_bracket:219,backslash:220,closebracket:221,single_quote:222}},{}],14:[function(f,h,m){h.exports=function(b,f){for(var h in f)f.hasOwnProperty(h)&&
(b[h]=f[h]);return b}},{}]},{},[9])(9)});
